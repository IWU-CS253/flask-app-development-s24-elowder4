{% extends "layout.html" %}
{% block body %}
  <form action="{{ url_for('add_entry') }}" method="post" class="add-entry">
    <dl>
      <dt>Title:</dt>
      <dd><input type="text" size="30" name="title" required></dd>
      <dt>Category:</dt>
      <dd><input type="text" size="30" name="category" required></dd>
      <dt>Text:</dt>
      <dd><textarea name="text" rows="5" cols="40" required></textarea></dd>
      <dd><input type="submit" value="Share"></dd>
    </dl>
  </form>
  <form action="{{ url_for('show_entries') }}" method="get" id="filter">
    <select name="filter" id="categories">
      <option selected value disabled>Filter By Category</option>
      <option value="noFilter">Show All</option>
      {% for entry in entries %}
      <option value="{{ entry.category }}">{{ entry.category }}</option>
      {% endfor %}
    </select>
  </form>
  <ul class="entries">
    {% for entry in filtered_entries %}
        <li>
          <form action="{{ url_for('delete_entry') }}" method="post" class="delete-entry">
            <input type="hidden" name="title" value="{{ entry.title }}">
            <input type="hidden" name="category" value="{{ entry.category }}">
            <input type="hidden" name="text" value="{{ entry.text }}">
            <h2>{{ entry.title }}</h2><h3>{{ entry.category }}</h3>{{ entry.text|safe }}
            <br>
            <input type="submit" value="Delete" name="delete">
          </form>
        </li>
    {% else %}
      <li><em>Unbelievable. No entries here so far</em></li>
    {% endfor %}
  </ul>
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('categories').addEventListener('change', function() {
        document.getElementById('filter').submit();
    });
  });
  </script>
{% endblock %}
